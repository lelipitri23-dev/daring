<!DOCTYPE html>
<html lang="id">
<%- include('layout_head') %>
<body class="flex flex-col min-h-screen">

    <%- include('navbar') %>

    <main class="flex-grow container mx-auto px-4 py-8 max-w-5xl">
        <nav class="text-sm text-gray-400 mb-4">
            <a href="/" class="hover:text-blue-400">Home</a> <span class="mx-2">/</span>
            <span class="text-white"><%= manga.title %></span>
        </nav>

        <div class="bg-gray-800 rounded-xl overflow-hidden shadow-2xl flex flex-col md:flex-row">
            <div class="md:w-1/3 bg-gray-900 p-6 flex flex-col items-center md:items-start text-center md:text-left border-r border-gray-800">
                
                <div class="w-48 aspect-[3/4] rounded-lg overflow-hidden shadow-lg mb-6 border-4 border-gray-700 mx-auto md:mx-0">
                    <% if (manga.thumb) { %>
                        <img src="<%= manga.thumb %>" alt="<%= manga.title %>" class="w-full h-full object-cover">
                    <% } else { %>
                        <div class="w-full h-full bg-gray-700 flex items-center justify-center text-6xl">üìñ</div>
                    <% } %>
                </div>

                <h1 class="text-2xl font-bold text-white mb-2 leading-tight"><%= manga.title %></h1>
                 <p class="text-blue-400 mb-6 font-medium text-sm"><%= manga.alternativeTitle %></p>
                
                <div class="w-full bg-gray-800 rounded-lg p-4 space-y-3 text-sm">
                    <div class="flex justify-between border-b border-gray-700 pb-2">
                        <span class="text-gray-400">Status</span>
                        <a href="/status/<%= manga.metadata.status.toLowerCase() %>" class="text-white hover:text-blue-400 font-medium"><%= manga.metadata.status %></a>
                    </div>
                    <div class="flex justify-between border-b border-gray-700 pb-2">
                        <span class="text-gray-400">Series</span>
                        <span class="text-white font-medium text-right truncate w-1/2"><%= manga.metadata.series %></span>
                    </div>
                    <div class="flex justify-between border-b border-gray-700 pb-2">
                        <span class="text-gray-400">Type</span>
                        <a href="/type/<%= manga.metadata.type ? (typeof manga.metadata.type === 'object' ? manga.metadata.type.type.toLowerCase() : manga.metadata.type.toLowerCase()) : '' %>" class="text-white hover:text-blue-400 font-medium">
                            <%= manga.metadata.type ? (typeof manga.metadata.type === 'object' ? manga.metadata.type : manga.metadata.type) : '-' %>
                        </a>
                    </div>
                    <div class="flex justify-between border-b border-gray-700 pb-2">
                        <span class="text-gray-400">Author</span>
                        <span class="text-white font-medium text-right truncate w-1/2"><%= manga.metadata.author %></span>
                    </div>
                    <div class="flex justify-between border-b border-gray-700 pb-2">
                        <span class="text-gray-400">Rating</span>
                        <span class="text-yellow-400 font-bold">‚≠ê <%= manga.metadata.rating %></span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-400">Rilis</span>
                        <span class="text-white font-medium"><%= manga.metadata.created %></span>
                    </div>
                </div>

                <div class="mt-6 flex flex-wrap gap-2 justify-center md:justify-start w-full">
                    <% manga.tags.forEach(tag => { %>
                        <a href="/genre/<%= tag.replace(/\s+/g, '-').toLowerCase() %>" 
                           class="bg-gray-800 text-xs px-3 py-1.5 rounded-full text-gray-300 hover:bg-blue-600 hover:text-white transition border border-gray-700">
                            <%= tag %>
                        </a>
                    <% }) %>
                </div>
            </div>

            <div class="md:w-2/3 p-6">
                <% if(manga.synopsis) { %>
                    <div class="mb-8">
                        <h2 class="text-lg font-bold text-white mb-2 border-l-4 border-blue-500 pl-3">Sinopsis</h2>
                        <p class="text-gray-300 text-sm leading-relaxed"><%= manga.synopsis %></p>
                    </div>
                <% } %>

                <h2 class="text-lg font-bold text-white mb-4 border-b border-gray-700 pb-2 flex items-center justify-between">
                    <span> Daftar Chapter</span>
                    <span class="text-xs bg-blue-900 text-blue-200 px-2 py-1 rounded"><%= chapters.length %> Chapter</span>
                </h2>

                <div class="flex flex-col gap-2 max-h-[600px] overflow-y-auto pr-2 custom-scrollbar">
                    <% if(chapters.length > 0) { %>
                        <% chapters.forEach(chap => { %>
                            <a href="/read/<%= manga.slug %>/<%= chap.slug %>" 
                               class="flex justify-between items-center bg-gray-750 hover:bg-gray-700 p-3 rounded-lg border border-gray-700 hover:border-blue-500 transition group">
                                <div class="flex flex-col">
                                    <span class="font-medium text-gray-200 group-hover:text-blue-400 text-sm transition">
                                        Chapter <%= chap.title %>
                                    </span>
                                    <span class="text-[10px] text-gray-500 mt-0.5">Bahasa Indonesia</span>
                                </div>
                                <span class="text-xs bg-gray-700 group-hover:bg-blue-600 text-gray-300 group-hover:text-white px-3 py-1 rounded-full transition">
                                    Baca
                                </span>
                            </a>
                        <% }) %>
                    <% } else { %>
                        <div class="text-center py-10 bg-gray-900/50 rounded-lg border border-dashed border-gray-700">
                            <p class="text-gray-500">Belum ada chapter tersedia.</p>
                        </div>
                    <% } %>
                </div>
            </div>
        </div>
    </main>

    <%- include('footer') %>
</body>
</html>
